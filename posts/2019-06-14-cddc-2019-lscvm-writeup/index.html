<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>CDDC 2019 LSCVM Writeup | David Zhu | Blog</title>
<meta name=keywords content="CTF,Reverse Engineering">
<meta name=description content="This is actually a challenge from the qualifiers, but because this challenge will be used in the Finals again so we weren&rsquo;t allowed to post about it until after the finals. More on that later, here&rsquo;s the writeup.
LSCVM: Immaculate Invasion  DESCRIPTION
During our recon on the notorious fools of LightSpeedCorp, we have discovered this service which runs on a really simple, tiny, trivial, virtual machine that they have created.">
<meta name=author content="David">
<link rel=canonical href=https://dzhy.dev/posts/2019-06-14-cddc-2019-lscvm-writeup/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://dzhy.dev/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://dzhy.dev/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://dzhy.dev/favicon-32x32.png>
<link rel=apple-touch-icon href=https://dzhy.dev/apple-touch-icon.png>
<link rel=mask-icon href=https://dzhy.dev/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.4">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<meta property="og:title" content="CDDC 2019 LSCVM Writeup">
<meta property="og:description" content="This is actually a challenge from the qualifiers, but because this challenge will be used in the Finals again so we weren&rsquo;t allowed to post about it until after the finals. More on that later, here&rsquo;s the writeup.
LSCVM: Immaculate Invasion  DESCRIPTION
During our recon on the notorious fools of LightSpeedCorp, we have discovered this service which runs on a really simple, tiny, trivial, virtual machine that they have created.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://dzhy.dev/posts/2019-06-14-cddc-2019-lscvm-writeup/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-06-14T00:00:00+00:00">
<meta property="article:modified_time" content="2019-06-14T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="CDDC 2019 LSCVM Writeup">
<meta name=twitter:description content="This is actually a challenge from the qualifiers, but because this challenge will be used in the Finals again so we weren&rsquo;t allowed to post about it until after the finals. More on that later, here&rsquo;s the writeup.
LSCVM: Immaculate Invasion  DESCRIPTION
During our recon on the notorious fools of LightSpeedCorp, we have discovered this service which runs on a really simple, tiny, trivial, virtual machine that they have created.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dzhy.dev/posts/"},{"@type":"ListItem","position":2,"name":"CDDC 2019 LSCVM Writeup","item":"https://dzhy.dev/posts/2019-06-14-cddc-2019-lscvm-writeup/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CDDC 2019 LSCVM Writeup","name":"CDDC 2019 LSCVM Writeup","description":"This is actually a challenge from the qualifiers, but because this challenge will be used in the Finals again so we weren\u0026rsquo;t allowed to post about it until after the finals. More on that later, here\u0026rsquo;s the writeup.\nLSCVM: Immaculate Invasion  DESCRIPTION\nDuring our recon on the notorious fools of LightSpeedCorp, we have discovered this service which runs on a really simple, tiny, trivial, virtual machine that they have created.","keywords":["CTF","Reverse Engineering"],"articleBody":"This is actually a challenge from the qualifiers, but because this challenge will be used in the Finals again so we weren’t allowed to post about it until after the finals. More on that later, here’s the writeup.\nLSCVM: Immaculate Invasion  DESCRIPTION\nDuring our recon on the notorious fools of LightSpeedCorp, we have discovered this service which runs on a really simple, tiny, trivial, virtual machine that they have created. We are not sure of its purpose, but it certainly looks fun to play with.\nlscvm-ii.cddc19q.ctf.sg 9001\nIMPORTANT: We highly recommend you to fully understand this challenge as we will use this VM again in the Final.\n Solution Looking at the strings in the binary, it looks like we are dealing with a Stack based vm, and those long strings are probably the instructions.\nIf we try running it we’ll get an error.\ncddc/re/LSCVM ➜ ./lscvm-ii\r[-] Flag file open error: No such file or directory\rWe find the code that is throwing the error and we can see it is trying to read a file called flag.\nLet’s create a file called flag to fix this error.\necho 'CTF{flag}'  flag Now when we run it we can see that it asks us for an ID which we have to figure out.\ncddc/re/LSCVM ➜ ./lscvm-ii\r=== Welcome to LSCVM(LightSpeed Corp Virtual Machine) ===\rID : 1\r[-] Wrong id\rAfter doing some analysis, I figured out that if argc is 2 the program will print out ‘debug’ information.\ncddc/re/LSCVM ➜ ./lscvm-ii a\r@0 c [ 02 ]\r@1 f [ 02 05 ]\r@2 M [ 0a ]\r@3 c [ 0a 02 ]\r@4 f [ 0a 02 05 ]\r@5 M [ 0a 0a ]\r@6 h [ 0a 0a 07 ]\r@7 i [ 0a 0a 07 08 ]\r@8 M [ 0a 0a 38 ]\r@9 f [ 0a 0a 38 05 ]\r@10 A [ 0a 0a 3d ]\r.\r.\r.\rThe information can be interpreted this way.\n   Instruction pointer instruction output Stack after running instruction     @0 c  [ 02 ]   @1 f  [ 02 05 ]   @2 M  [ 0a ]    Using the debug output and static analysis, I was able to recover the whole instruction set.\n   Opcode (Hex) Opcode (Char) Assmebly Comment     Default NIL nop no operation, waste cycle   0x0a \\n nop no operation, waste cycle   0x20 \\s nop no operation, waste cycle   0x41 A add Pop 2 values from stack and push the addition   0x42 B hlt Stop executing code   0x43 C jmp Pop and jump to value   0x44 D pop Pop a value and do nothing   0x45 E read Pop addr and push val. 0 0x3fff   0x46 F sclone pop value n and (clone) push n+1 th previous stack value   0x47 G ipadd Pop value and add it to IP (Instruction Pointer)   0x48 H sshift pop value n and shift n+1 th previous stack value to the top of the stack   0x49 I pint Pop value and Print as int   0x4a J cmp pop 2 values and push 0 if equal, 1 if first pop is smaller else -1. 0   0x4b K write first pop is addr, 2nd pop is value to write   0x4d M mul Pop 2 values from stack and push the multiplication   0x50 P pchar Pops value from stack and print as char   0x52 R rjmp Jump to previous jump location, cant do twice in a row, because it consumes the previous jump location.   0x53 S sub subtract 1st pop from 2nd pop push result   0x56 V div Divide (floor) 2nd pop by 1st pop and push result   0x5a Z ipcadd conditional add to IP, if 2nd pop is 0, add 1st pop to IP   0x61 a p0 Push 0x00 to stack   0x62 b p1 Push 0x01 to stack   0x63 c p2 Push 0x02 to stack   0x64 d p3 Push 0x03 to stack   0x65 e p4 Push 0x04 to stack   0x66 f p5 Push 0x05 to stack   0x67 g p6 Push 0x06 to stack   0x68 h p7 Push 0x07 to stack   0x69 i p8 Push 0x08 to stack   0x6a j p9 Push 0x09 to stack    The input we are giving the program is actually being executed by the vm as code.\nTo get the flag, we have to provide the vm with code that will write lsc_user to the vm memory, and then provide another code that will write hi_darkspeed-corp! to the vm memory.\nUsing the instruction set recovered I wrote this script to generate the vm code required to write the strings to memory and submit it to the service.\n#!/usr/bin/env python3 import socket nums = { 0x00:'a', 0x01:'b', 0x02:'c', 0x03:'d', 0x04:'e', 0x05:'f', 0x06:'g', 0x07:'h', 0x08:'i', 0x09:'j', 0x0a:'jbA', 0x0b:'jcA', 0x0c:'jdA', 0x0d:'jeA', 0x0e:'jfA', 0x0f:'jgA', 0x10:'jhA', 0x11:'jiA', 0x12:'jjA', 0x21:'eiMbA', 0x2d:'jfM', 0x5f:'jjMchMA', 0x61:'jjMcjMAcS', 0x63:'jjMcjMA', 0x64:'jjMcjMAbA', 0x65:'jjMcjMAcA', 0x68:'jjMdhMcAA', 0x69:'jjMdhMdAA', 0x6b:'jjMdjMAbS', 0x6c:'jjMdjMA', 0x6f:'jjMdjMAdA', 0x70:'jjMfhMeSA', 0x72:'jjMfhMcSA', 0x73:'jjMfhMbSA', 0x75:'jjMfhMbAA'} def write_str(target): output = '' for i in range(len(target)): output += nums[ord(target[i])] + nums[i] return output + 'K' * len(target) id_code = write_str('lsc_user') pass_code = write_str('hi_darkspeed-corp!') print('ID: {}\\nPassword: {}\\n'.format(id_code, pass_code)) print('Connecting to service...') client=socket.socket(socket.AF_INET,socket.SOCK_STREAM) client.connect(('lscvm-ii.cddc19q.ctf.sg',9001)) client.sendall('{}\\n'.format(id_code).encode()) client.sendall('{}\\n'.format(pass_code).encode()) while True: msg = client.recv(1024).decode() if msg: print(msg) if '$CDDC19${' in msg: client.close() break cddc/re/LSCVM ➜ ./solve.py\rID: jjMdjMAajjMfhMbSAbjjMcjMAcjjMchMAdjjMfhMbAAejjMfhMbSAfjjMcjMAcAgjjMfhMcSAhKKKKKKKK\rPassword: jjMdhMcAAajjMdhMdAAbjjMchMAcjjMcjMAbAdjjMcjMAcSejjMfhMcSAfjjMdjMAbSgjjMfhMbSAhjjMfhMeSA\rijjMcjMAcAjjjMcjMAcAjbAjjMcjMAbAjcAjfMjdAjjMcjMAjeAjjMdjMAdAjfAjjMfhMcSAjgAjjMfhMeSAjhAeiMbAjiAKK\rKKKKKKKKKKKKKKKK\rConnecting to service...\r=== Welcome to LSCVM(LightSpeed Corp Virtual Machine) ===\rID : Password :\rLogin Successful! $CDDC19${IcY_GrE37ings_Fr0M_LigHT5pEeDC0Rp}\rlsc_user, Good Bye!\rFlag $CDDC19${IcY_GrE37ings_Fr0M_LigHT5pEeDC0Rp}\rRant The organizers stated in the qualifiers LSCVM challenges that it is important to fully understand the VM as it will be used again in the Finals.\n IMPORTANT: We highly recommend you to fully understand this challenge as we will use this VM again in the Final.\n The way they brought this accross made me think that it will play a big part in the finals, so I built a tool for the purpose of working on LSCVM challenge(s) during the Finals. However LSCVM was not a big part of the Finals and I didn’t get to use my tool at all.\nThe finals also had Rings where you have to solve a certain number of challenges to unlock the next ring. Personally I don’t think the rings concept is a good idea, because what if it just so happens the participant can’t solve the starting challenges but they can solve the ones in the next or next next ring? I would’ve preferred it if the challenges were all available at the start.\nI understand that it was implemented to limit the number of teams that can attempt the hardware challenges because they don’t have enought equipment for everyone to attempt at the same time, but this can also be done by only unlocking the hardware challenges once a team reach a certain number of points/solves, instead of implementing Rings.\nThere’s not gonna be any writeup for the finals challenges cause I did everything on the provided laptop and didn’t transfer the files out.\n","wordCount":"1147","inLanguage":"en","datePublished":"2019-06-14T00:00:00Z","dateModified":"2019-06-14T00:00:00Z","author":{"@type":"Person","name":"David"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dzhy.dev/posts/2019-06-14-cddc-2019-lscvm-writeup/"},"publisher":{"@type":"Organization","name":"David Zhu | Blog","logo":{"@type":"ImageObject","url":"https://dzhy.dev/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://dzhy.dev/ accesskey=h title="David Zhu | Blog (Alt + H)">David Zhu | Blog</a>
<span class=logo-switches>
</span>
</div>
<ul id=menu>
<li>
<a href=https://dzhy.dev/about/ title=about>
<span>about</span>
</a>
</li>
<li>
<a href=https://dzhy.dev/archive/ title=archive>
<span>archive</span>
</a>
</li>
<li>
<a href=https://dzhy.dev/tags/ title=tags>
<span>tags</span>
</a>
</li>
<li>
<a href=https://dzhy.dev/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://dzhy.dev/>Home</a>&nbsp;»&nbsp;<a href=https://dzhy.dev/posts/>Posts</a></div>
<h1 class=post-title>
CDDC 2019 LSCVM Writeup
</h1>
<div class=post-meta><span title="2019-06-14 00:00:00 +0000 UTC">June 14, 2019</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;David
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#lscvm-immaculate-invasion aria-label="LSCVM: Immaculate Invasion">LSCVM: Immaculate Invasion</a><ul>
<li>
<a href=#solution aria-label=Solution>Solution</a></li>
<li>
<a href=#flag aria-label=Flag>Flag</a></li></ul>
</li>
<li>
<a href=#rant aria-label=Rant>Rant</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><p>This is actually a challenge from the qualifiers, but because this challenge will be used in the Finals again so we weren&rsquo;t allowed to post about it until after the finals. More on that <a href=#rant>later</a>, here&rsquo;s the writeup.</p>
<h2 id=lscvm-immaculate-invasion>LSCVM: Immaculate Invasion<a hidden class=anchor aria-hidden=true href=#lscvm-immaculate-invasion>#</a></h2>
<blockquote>
<p>DESCRIPTION</p>
<p>During our recon on the notorious fools of LightSpeedCorp, we have discovered this service which runs on a really simple, tiny, trivial, virtual machine that they have created. We are not sure of its purpose, but it certainly looks fun to play with.</p>
<p><strong>lscvm-ii.cddc19q.ctf.sg 9001</strong></p>
<p>IMPORTANT: We highly recommend you to fully understand this challenge as we will use this VM again in the Final.</p>
</blockquote>
<h3 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h3>
<p>Looking at the strings in the binary, it looks like we are dealing with a Stack based vm, and those long strings are probably the instructions.</p>
<p><img loading=lazy src=/2019-06-14-CDDC-2019-LSCVM-Writeup/lscvm_strings.png alt=Strings>
</p>
<p>If we try running it we&rsquo;ll get an error.</p>
<pre tabindex=0><code>cddc/re/LSCVM ➜ ./lscvm-ii
[-] Flag file open error: No such file or directory
</code></pre><p>We find the code that is throwing the error and we can see it is trying to read a file called flag.</p>
<p><img loading=lazy src=/2019-06-14-CDDC-2019-LSCVM-Writeup/read_flag.png alt="Read flag">
</p>
<p>Let&rsquo;s create a file called flag to fix this error.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>echo <span style=color:#e6db74>&#39;CTF{flag}&#39;</span> &gt; flag
</code></pre></div><p>Now when we run it we can see that it asks us for an ID which we have to figure out.</p>
<pre tabindex=0><code>cddc/re/LSCVM ➜ ./lscvm-ii

=== Welcome to LSCVM(LightSpeed Corp Virtual Machine) ===

ID : 1
[-] Wrong id
</code></pre><p>After doing some analysis, I figured out that if argc is 2 the program will print out &lsquo;debug&rsquo; information.</p>
<pre tabindex=0><code>cddc/re/LSCVM ➜ ./lscvm-ii a
@0 c [ 02 ]
@1 f [ 02 05 ]
@2 M [ 0a ]
@3 c [ 0a 02 ]
@4 f [ 0a 02 05 ]
@5 M [ 0a 0a ]
@6 h [ 0a 0a 07 ]
@7 i [ 0a 0a 07 08 ]
@8 M [ 0a 0a 38 ]
@9 f [ 0a 0a 38 05 ]
@10 A [ 0a 0a 3d ]
.
.
.
</code></pre><p>The information can be interpreted this way.</p>
<table>
<thead>
<tr>
<th>Instruction pointer</th>
<th>instruction</th>
<th>output</th>
<th>Stack after running instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td>@0</td>
<td>c</td>
<td></td>
<td>[ 02 ]</td>
</tr>
<tr>
<td>@1</td>
<td>f</td>
<td></td>
<td>[ 02 05 ]</td>
</tr>
<tr>
<td>@2</td>
<td>M</td>
<td></td>
<td>[ 0a ]</td>
</tr>
</tbody>
</table>
<p>Using the debug output and static analysis, I was able to recover the whole instruction set.</p>
<table>
<thead>
<tr>
<th>Opcode (Hex)</th>
<th>Opcode (Char)</th>
<th>Assmebly</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Default</td>
<td>NIL</td>
<td>nop</td>
<td>no operation, waste cycle</td>
</tr>
<tr>
<td>0x0a</td>
<td>\n</td>
<td>nop</td>
<td>no operation, waste cycle</td>
</tr>
<tr>
<td>0x20</td>
<td>\s</td>
<td>nop</td>
<td>no operation, waste cycle</td>
</tr>
<tr>
<td>0x41</td>
<td>A</td>
<td>add</td>
<td>Pop 2 values from stack and push the addition</td>
</tr>
<tr>
<td>0x42</td>
<td>B</td>
<td>hlt</td>
<td>Stop executing code</td>
</tr>
<tr>
<td>0x43</td>
<td>C</td>
<td>jmp</td>
<td>Pop and jump to value</td>
</tr>
<tr>
<td>0x44</td>
<td>D</td>
<td>pop</td>
<td>Pop a value and do nothing</td>
</tr>
<tr>
<td>0x45</td>
<td>E</td>
<td>read</td>
<td>Pop addr and push val. <code>0</code> &lt;= addr &lt;= <code>0x3fff</code></td>
</tr>
<tr>
<td>0x46</td>
<td>F</td>
<td>sclone</td>
<td>pop value n and (clone) push n+1 th previous stack value</td>
</tr>
<tr>
<td>0x47</td>
<td>G</td>
<td>ipadd</td>
<td>Pop value and add it to IP (Instruction Pointer)</td>
</tr>
<tr>
<td>0x48</td>
<td>H</td>
<td>sshift</td>
<td>pop value n and shift n+1 th previous stack value to the top of the stack</td>
</tr>
<tr>
<td>0x49</td>
<td>I</td>
<td>pint</td>
<td>Pop value and Print as int</td>
</tr>
<tr>
<td>0x4a</td>
<td>J</td>
<td>cmp</td>
<td>pop 2 values and push 0 if equal, 1 if first pop is smaller else -1. <code>0</code></td>
</tr>
<tr>
<td>0x4b</td>
<td>K</td>
<td>write</td>
<td>first pop is addr, 2nd pop is value to write</td>
</tr>
<tr>
<td>0x4d</td>
<td>M</td>
<td>mul</td>
<td>Pop 2 values from stack and push the multiplication</td>
</tr>
<tr>
<td>0x50</td>
<td>P</td>
<td>pchar</td>
<td>Pops value from stack and print as char</td>
</tr>
<tr>
<td>0x52</td>
<td>R</td>
<td>rjmp</td>
<td>Jump to previous jump location, cant do twice in a row, because it consumes the previous jump location.</td>
</tr>
<tr>
<td>0x53</td>
<td>S</td>
<td>sub</td>
<td>subtract 1st pop from 2nd pop push result</td>
</tr>
<tr>
<td>0x56</td>
<td>V</td>
<td>div</td>
<td>Divide (floor) 2nd pop by 1st pop and push result</td>
</tr>
<tr>
<td>0x5a</td>
<td>Z</td>
<td>ipcadd</td>
<td>conditional add to IP, if 2nd pop is 0, add 1st pop to IP</td>
</tr>
<tr>
<td>0x61</td>
<td>a</td>
<td>p0</td>
<td>Push 0x00 to stack</td>
</tr>
<tr>
<td>0x62</td>
<td>b</td>
<td>p1</td>
<td>Push 0x01 to stack</td>
</tr>
<tr>
<td>0x63</td>
<td>c</td>
<td>p2</td>
<td>Push 0x02 to stack</td>
</tr>
<tr>
<td>0x64</td>
<td>d</td>
<td>p3</td>
<td>Push 0x03 to stack</td>
</tr>
<tr>
<td>0x65</td>
<td>e</td>
<td>p4</td>
<td>Push 0x04 to stack</td>
</tr>
<tr>
<td>0x66</td>
<td>f</td>
<td>p5</td>
<td>Push 0x05 to stack</td>
</tr>
<tr>
<td>0x67</td>
<td>g</td>
<td>p6</td>
<td>Push 0x06 to stack</td>
</tr>
<tr>
<td>0x68</td>
<td>h</td>
<td>p7</td>
<td>Push 0x07 to stack</td>
</tr>
<tr>
<td>0x69</td>
<td>i</td>
<td>p8</td>
<td>Push 0x08 to stack</td>
</tr>
<tr>
<td>0x6a</td>
<td>j</td>
<td>p9</td>
<td>Push 0x09 to stack</td>
</tr>
</tbody>
</table>
<p>The input we are giving the program is actually being executed by the vm as code.</p>
<p>To get the flag, we have to provide the vm with code that will write <code>lsc_user</code> to the vm memory, and then provide another code that will write <code>hi_darkspeed-corp!</code> to the vm memory.</p>
<p><img loading=lazy src=/2019-06-14-CDDC-2019-LSCVM-Writeup/get_flag.png alt="Get flag conditions">
</p>
<p>Using the instruction set recovered I wrote this script to generate the vm code required to write the strings to memory and submit it to the service.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>
<span style=color:#f92672>import</span> socket

nums <span style=color:#f92672>=</span> {
<span style=color:#ae81ff>0x00</span>:<span style=color:#e6db74>&#39;a&#39;</span>,
<span style=color:#ae81ff>0x01</span>:<span style=color:#e6db74>&#39;b&#39;</span>,
<span style=color:#ae81ff>0x02</span>:<span style=color:#e6db74>&#39;c&#39;</span>,
<span style=color:#ae81ff>0x03</span>:<span style=color:#e6db74>&#39;d&#39;</span>,
<span style=color:#ae81ff>0x04</span>:<span style=color:#e6db74>&#39;e&#39;</span>,
<span style=color:#ae81ff>0x05</span>:<span style=color:#e6db74>&#39;f&#39;</span>,
<span style=color:#ae81ff>0x06</span>:<span style=color:#e6db74>&#39;g&#39;</span>,
<span style=color:#ae81ff>0x07</span>:<span style=color:#e6db74>&#39;h&#39;</span>,
<span style=color:#ae81ff>0x08</span>:<span style=color:#e6db74>&#39;i&#39;</span>,
<span style=color:#ae81ff>0x09</span>:<span style=color:#e6db74>&#39;j&#39;</span>,
<span style=color:#ae81ff>0x0a</span>:<span style=color:#e6db74>&#39;jbA&#39;</span>,
<span style=color:#ae81ff>0x0b</span>:<span style=color:#e6db74>&#39;jcA&#39;</span>,
<span style=color:#ae81ff>0x0c</span>:<span style=color:#e6db74>&#39;jdA&#39;</span>,
<span style=color:#ae81ff>0x0d</span>:<span style=color:#e6db74>&#39;jeA&#39;</span>,
<span style=color:#ae81ff>0x0e</span>:<span style=color:#e6db74>&#39;jfA&#39;</span>,
<span style=color:#ae81ff>0x0f</span>:<span style=color:#e6db74>&#39;jgA&#39;</span>,
<span style=color:#ae81ff>0x10</span>:<span style=color:#e6db74>&#39;jhA&#39;</span>,
<span style=color:#ae81ff>0x11</span>:<span style=color:#e6db74>&#39;jiA&#39;</span>,
<span style=color:#ae81ff>0x12</span>:<span style=color:#e6db74>&#39;jjA&#39;</span>,
<span style=color:#ae81ff>0x21</span>:<span style=color:#e6db74>&#39;eiMbA&#39;</span>,
<span style=color:#ae81ff>0x2d</span>:<span style=color:#e6db74>&#39;jfM&#39;</span>,
<span style=color:#ae81ff>0x5f</span>:<span style=color:#e6db74>&#39;jjMchMA&#39;</span>,
<span style=color:#ae81ff>0x61</span>:<span style=color:#e6db74>&#39;jjMcjMAcS&#39;</span>,
<span style=color:#ae81ff>0x63</span>:<span style=color:#e6db74>&#39;jjMcjMA&#39;</span>,
<span style=color:#ae81ff>0x64</span>:<span style=color:#e6db74>&#39;jjMcjMAbA&#39;</span>,
<span style=color:#ae81ff>0x65</span>:<span style=color:#e6db74>&#39;jjMcjMAcA&#39;</span>,
<span style=color:#ae81ff>0x68</span>:<span style=color:#e6db74>&#39;jjMdhMcAA&#39;</span>,
<span style=color:#ae81ff>0x69</span>:<span style=color:#e6db74>&#39;jjMdhMdAA&#39;</span>,
<span style=color:#ae81ff>0x6b</span>:<span style=color:#e6db74>&#39;jjMdjMAbS&#39;</span>,
<span style=color:#ae81ff>0x6c</span>:<span style=color:#e6db74>&#39;jjMdjMA&#39;</span>,
<span style=color:#ae81ff>0x6f</span>:<span style=color:#e6db74>&#39;jjMdjMAdA&#39;</span>,
<span style=color:#ae81ff>0x70</span>:<span style=color:#e6db74>&#39;jjMfhMeSA&#39;</span>,
<span style=color:#ae81ff>0x72</span>:<span style=color:#e6db74>&#39;jjMfhMcSA&#39;</span>,
<span style=color:#ae81ff>0x73</span>:<span style=color:#e6db74>&#39;jjMfhMbSA&#39;</span>,
<span style=color:#ae81ff>0x75</span>:<span style=color:#e6db74>&#39;jjMfhMbAA&#39;</span>}

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>write_str</span>(target):
    output <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(target)):
        output <span style=color:#f92672>+=</span> nums[ord(target[i])] <span style=color:#f92672>+</span> nums[i]

    <span style=color:#66d9ef>return</span> output <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;K&#39;</span> <span style=color:#f92672>*</span> len(target)

id_code <span style=color:#f92672>=</span> write_str(<span style=color:#e6db74>&#39;lsc_user&#39;</span>)
pass_code <span style=color:#f92672>=</span> write_str(<span style=color:#e6db74>&#39;hi_darkspeed-corp!&#39;</span>)
print(<span style=color:#e6db74>&#39;ID: </span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Password: </span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(id_code, pass_code))

print(<span style=color:#e6db74>&#39;Connecting to service...&#39;</span>)
client<span style=color:#f92672>=</span>socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_INET,socket<span style=color:#f92672>.</span>SOCK_STREAM)
client<span style=color:#f92672>.</span>connect((<span style=color:#e6db74>&#39;lscvm-ii.cddc19q.ctf.sg&#39;</span>,<span style=color:#ae81ff>9001</span>))
client<span style=color:#f92672>.</span>sendall(<span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(id_code)<span style=color:#f92672>.</span>encode())
client<span style=color:#f92672>.</span>sendall(<span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(pass_code)<span style=color:#f92672>.</span>encode())
<span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
    msg <span style=color:#f92672>=</span> client<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>1024</span>)<span style=color:#f92672>.</span>decode()
    <span style=color:#66d9ef>if</span> msg:
        print(msg)
        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;$CDDC19${&#39;</span> <span style=color:#f92672>in</span> msg:
            client<span style=color:#f92672>.</span>close()
            <span style=color:#66d9ef>break</span>
</code></pre></div><pre tabindex=0><code>cddc/re/LSCVM ➜ ./solve.py
ID: jjMdjMAajjMfhMbSAbjjMcjMAcjjMchMAdjjMfhMbAAejjMfhMbSAfjjMcjMAcAgjjMfhMcSAhKKKKKKKK
Password: jjMdhMcAAajjMdhMdAAbjjMchMAcjjMcjMAbAdjjMcjMAcSejjMfhMcSAfjjMdjMAbSgjjMfhMbSAhjjMfhMeSA
ijjMcjMAcAjjjMcjMAcAjbAjjMcjMAbAjcAjfMjdAjjMcjMAjeAjjMdjMAdAjfAjjMfhMcSAjgAjjMfhMeSAjhAeiMbAjiAKK
KKKKKKKKKKKKKKKK

Connecting to service...


=== Welcome to LSCVM(LightSpeed Corp Virtual Machine) ===

ID : Password :
Login Successful! $CDDC19${IcY_GrE37ings_Fr0M_LigHT5pEeDC0Rp}

lsc_user, Good Bye!
</code></pre><h3 id=flag>Flag<a hidden class=anchor aria-hidden=true href=#flag>#</a></h3>
<pre tabindex=0><code>$CDDC19${IcY_GrE37ings_Fr0M_LigHT5pEeDC0Rp}
</code></pre><h2 id=rant>Rant<a hidden class=anchor aria-hidden=true href=#rant>#</a></h2>
<p>The organizers stated in the qualifiers LSCVM challenges that it is important to fully understand the VM as it will be used again in the Finals.</p>
<blockquote>
<p>IMPORTANT: We highly recommend you to fully understand this challenge as we will use this VM again in the Final.</p>
</blockquote>
<p>The way they brought this accross made me think that it will play a big part in the finals, so I built a <a href=https://github.com/PotatoDrug/LSCVM-Tool>tool</a> for the purpose of working on LSCVM challenge(s) during the Finals. However LSCVM was not a big part of the Finals and I didn&rsquo;t get to use my tool at all.</p>
<p>The finals also had Rings where you have to solve a certain number of challenges to unlock the next ring. Personally I don&rsquo;t think the rings concept is a good idea, because what if it just so happens the participant can&rsquo;t solve the starting challenges but they can solve the ones in the next or next next ring? I would&rsquo;ve preferred it if the challenges were all available at the start.</p>
<p>I understand that it was implemented to limit the number of teams that can attempt the hardware challenges because they don&rsquo;t have enought equipment for everyone to attempt at the same time, but this can also be done by only unlocking the hardware challenges once a team reach a certain number of points/solves, instead of implementing Rings.</p>
<p>There&rsquo;s not gonna be any writeup for the finals challenges cause I did everything on the provided laptop and didn&rsquo;t transfer the files out.</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://dzhy.dev/tags/ctf/>CTF</a></li>
<li><a href=https://dzhy.dev/tags/reverse-engineering/>Reverse Engineering</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://dzhy.dev/posts/2019-07-20-sni-esni/>
<span class=title>« Prev Page</span>
<br>
<span>SNI and ESNI</span>
</a>
<a class=next href=https://dzhy.dev/posts/2019-06-04-cddc-2019-qualifiers-writeup/>
<span class=title>Next Page »</span>
<br>
<span>CDDC 2019 Qualifiers Writeup</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://dzhy.dev/>David Zhu | Blog</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0,theme:'dark'})</script>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>